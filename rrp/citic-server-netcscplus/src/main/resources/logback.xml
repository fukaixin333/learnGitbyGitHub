<?xml version="1.0" encoding="UTF-8"?>
<configuration scan="true" scanPeriod="30 seconds" debug="false">
	<include resource="logback-local.xml" optional="true" />

	<!-- <timestamp key="birth" datePattern="yyyy-MM-dd HH:mm:ss.SSS" /> -->
	<property name="filepath" value="${log.filepath:-${user.dir}}/temp/logs" />
	<property name="filename" value="${log.filename:-System}" />

	<conversionRule conversionWord="hlight" converterClass="com.citic.server.logback.HighlightingCompositeConverter" />

	<appender name="STDOUT" class="com.citic.server.logback.ANSIConsoleAppender">
		<withJansi>true</withJansi>
		<encoder>
			<pattern>%date{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %hlight(%-5level %logger{32} - %msg%n)</pattern>
		</encoder>
		<target>System.out</target>
	</appender>

	<appender name="RFST" class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${filepath}/${filename}.log</file>
		<rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
			<fileNamePattern>${filepath}/${filename}_%d{yyyyMMdd}_%i.log</fileNamePattern>
			<maxHistory>30</maxHistory>
			<maxFileSize>128MB</maxFileSize>
			<totalSizeCap>10240MB</totalSizeCap>
		</rollingPolicy>
		<encoder>
			<pattern>%date{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{32} - %msg%n</pattern>
		</encoder>
	</appender>

	<root level="${log.level.active:-${log.level.default:-DEBUG}}">
		<appender-ref ref="STDOUT" />
		<appender-ref ref="RFST" />
	</root>

	<logger name="com.citic.server" level="${log.level.server}" />
	<logger name="com.citic.server.mapper" level="${log.level.server.mapper}" additivity="true" />
	<logger name="com.citic.server.net.mapper" level="${log.level.server.mapper}" additivity="true" />

	<!-- EhCache -->
	<logger name="Cache Hit" level="${log.level.ehcache:-WARN}" />
	<logger name="net.sf.ehcache" level="${log.level.ehcache:-WARN}" additivity="true" />

	<!-- MyBatis -->
	<logger name="org.apache.ibatis" level="${log.level.mybatis:-WARN}" additivity="true" />
	<logger name="org.mybatis.spring" level="${log.level.mybatis:-WARN}" additivity="true" />

	<!-- Alibaba -->
	<logger name="druid.sql" level="${log.level.druid:-WARN}" additivity="${log.druid.sql:-false}" />
	<logger name="com.alibaba.druid" level="${log.level.druid:-WARN}" />
	<logger name="com.alibaba.druid.filter.stat.StatFilter" level="${log.level.druid:-ERROR}" />

	<!-- MINA -->
	<logger name="org.apache.mina" level="${log.level.mina:-WARN}" additivity="${log.mina:-true}" />
</configuration>
